var inpoot={};!function(t){"use strict";var a=function(t,a){return-1!==t.indexOf(a)},e=navigator.userAgent,o=(a(e,"Windows NT"),a(e,"Macintosh"),a(e,"Chrome/"),{});if(a(e,"Firefox/")){navigator.mozGamepads=[];window.addEventListener("MozGamepadConnected",function(t){navigator.mozGamepads[t.gamepad.index]=t.gamepad}),window.addEventListener("MozGamepadDisconnected",function(t){navigator.mozGamepads[t.gamepad.index]=void 0})}var n,i=function(t){for(var e in inpoot.gamepads)for(var o=inpoot.gamepads[e],n=o.idMatches,i=0;i<n.length;i++){for(var p=n[i],s=!0,d=0;d<p.length;d++)a(t.id,p[d])||(s=!1);if(s)return t.displayName=o.displayName,void(t.gpadType=e)}t.gpadType=t.id,t.displayName="Unknown gamepad"},p={},s={},d={},l=!1,r=0,c=!1,u=!1,m=1,g={mouse:{},keyboard:{},gamepad:{}},v={},f=function(t){o[t.keyCode]=1},y=function(t){o[t.keyCode]=0},b={1:"mouse_button_left",2:"mouse_button_middle",3:"mouse_button_right"},x=function(t){g.mouse[b[t.which]]=1},h=function(t){g.mouse[b[t.which]]=0},k=function(t){r=0;var a=t.movementX||t.mozMovementX||t.webkitMovementX||0,e=t.movementY||t.mozMovementY||t.webkitMovementY||0;a||e?(g.mouse.mouseDX=a,g.mouse.mouseDY=e):(g.mouse.mouseXL=g.mouse.mouseX,g.mouse.mouseYL=g.mouse.mouseY,g.mouse.mouseX=t.clientX/window.innerWidth*2-1,g.mouse.mouseY=t.clientY/window.innerHeight*2-1,g.mouse.mouseDX=g.mouse.mouseX-g.mouse.mouseXL,g.mouse.mouseDY=g.mouse.mouseY-g.mouse.mouseYL)},_=function(){var t=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():navigator.mozGetGamepads?navigator.mozGetGamepads():[];return window.gyayer=t,t},w=function(){var t=[],a=_(),e=0;for(var o in a)a[o]&&"length"!==o&&a.hasOwnProperty(o)&&(e++,i(a[o]),t.push({player:e,gamepad:a[o],gamepadIndex:o}),g.gamepad[o]||(g.gamepad[o]={type:a[o].gpadType,values:{}}));return t};inpoot.initialize=function(a){document.onkeydown=f,document.onkeyup=y,document.onmousemove=k,document.onmousedown=x,document.onmouseup=h,p=w(),s=a.actions,m=a.maxPlayers||1,n=a.mouseNormalizer||3,d=t.storage.getObject("gamepadmaps")||{},a.mappings&&null===t.storage.getObject("inpoot_action_mappings")&&inpoot.setMappings(a.mappings),a.players&&null===t.storage.getObject("inpoot_stored_players")&&inpoot.setPlayers(a.players)};var T=function(){d=t.storage.getObject("gamepadmaps")||{}},I=function(t,a,e){return!!d[t]&&d[t].rawToButton[a][e]},C=function(t,a,e){return E(t)[a][e].name||e},M=function(t,a,e){var o,n=d[t].rawToButton.axesMap[a];if(n){o=C(t,"axis_dual",n.bid);n.subType;return{text:o+" "+n.direction,value:n.bid,buttonType:"axis_dual",subType:n.subType,direction:n.direction}}o=C(t,"button",a);d[t].rawToButton.buttons[a];return{text:o,value:a,buttonType:"button",subType:""}},O=0,B=!1;inpoot.refreshParams=function(){B=!0};var N=.07;inpoot.setThreshold=function(t){N=t},inpoot.tick=function(a){if(!l||a){++r>1&&(g.mouse.mouseDX=0,g.mouse.mouseDY=0),v=t.extend(!0,{},g),g.keyboard=t.extend(!0,{},o),0===O&&(p=w(),L()),O=(O+1)%1e3,B&&(O=0,B=!1);for(var e=_(),n=0;n<p.length;n++){var i=p[n],s=e[i.gamepadIndex];if(s&&s.gpadType){for(var d=0;d<s.buttons.length;d++)try{g.gamepad[i.gamepadIndex].values[I(s.gpadType,"buttons",d).bid]=s.buttons[d].value}catch(t){}for(var c=0;c<s.axes.length;c++){var u=I(s.gpadType,"axes",c),m=Math.abs(s.axes[c]),f=m>N?m:0;"x"===u.subType?s.axes[c]<=0?(g.gamepad[i.gamepadIndex].values[u.bid+"left"]=f,g.gamepad[i.gamepadIndex].values[u.bid+"right"]=0):(g.gamepad[i.gamepadIndex].values[u.bid+"left"]=0,g.gamepad[i.gamepadIndex].values[u.bid+"right"]=f):s.axes[c]<=0?(g.gamepad[i.gamepadIndex].values[u.bid+"up"]=f,g.gamepad[i.gamepadIndex].values[u.bid+"down"]=0):(g.gamepad[i.gamepadIndex].values[u.bid+"up"]=0,g.gamepad[i.gamepadIndex].values[u.bid+"down"]=f)}}}return g}};var j={},S={},D={},L=function(){j={};var a=t.storage.getObject("inpoot_stored_players");for(var e in a){var o=a[e];j[o.number]={actionMapId:o.actionMapId,gamepad:o.gamepad,gamepadIndex:o.options.gpadIndex,invert:o.options.axes}}S=t.storage.getObject("inpoot_action_mappings");for(var n=0;n<S.length;n++)D[S[n].id]=n};inpoot.action=function(t,a,e){e=e||{};var o,i,p,s={pressed:0,delta:0,val:0},d=j[a=a||1];if(d&&S[D[d.actionMapId]]&&(o=S[D[d.actionMapId]].mapping[t]))for(var l=o.inputs||[],r=0;r<l.length;r++)for(var c=0;c<l[r].inputs.length;c++)"keyboard"==l[r].inputs[c].type?(void 0===g.keyboard[l[r].inputs[c].value]&&(g.keyboard[l[r].inputs[c].value]=0),i=g.keyboard[l[r].inputs[c].value],p=v.keyboard[l[r].inputs[c].value],s.val=i,s.pressed=!i&&p,s.delta=i-p,s.pressed&&e.clear&&(g.keyboard[l[r].inputs[c].value]=0,v.keyboard[l[r].inputs[c].value]=0)):"gamepad"==l[r].inputs[c].type?!1!==g.gamepad[d.gamepadIndex]&&void 0!==g.gamepad[d.gamepadIndex]&&("axis_dual"==l[r].inputs[c].buttonType?(d.invert&&d.invert[l[r].inputs[c].value]&&("up"==l[r].inputs[c].direction||"down"==l[r].inputs[c].direction)?"up"==l[r].inputs[c].direction?(i=g.gamepad[d.gamepadIndex].values[l[r].inputs[c].value+"down"],p=v.gamepad[d.gamepadIndex]?v.gamepad[d.gamepadIndex].values[l[r].inputs[c].value+"down"]:0):(i=g.gamepad[d.gamepadIndex].values[l[r].inputs[c].value+"up"],p=v.gamepad[d.gamepadIndex]?v.gamepad[d.gamepadIndex].values[l[r].inputs[c].value+"up"]:0):(i=g.gamepad[d.gamepadIndex].values[l[r].inputs[c].value+l[r].inputs[c].direction],p=v.gamepad[d.gamepadIndex]?v.gamepad[d.gamepadIndex].values[l[r].inputs[c].value+l[r].inputs[c].direction]:0),s.val=i,s.pressed=!i&&p,s.delta=i-p,s.pressed&&e.clear&&(g.gamepad[d.gamepadIndex].values[l[r].inputs[c].value+l[r].inputs[c].direction]=0,v.gamepad[d.gamepadIndex].values[l[r].inputs[c].value+l[r].inputs[c].direction]=0)):(i=g.gamepad[d.gamepadIndex].values[l[r].inputs[c].value],p=v.gamepad[d.gamepadIndex]?v.gamepad[d.gamepadIndex].values[l[r].inputs[c].value]:0,s.val=i,s.pressed=!i&&p,s.delta=i-p,s.pressed&&e.clear&&(g.gamepad[d.gamepadIndex].values[l[r].inputs[c].value]=0,v.gamepad[d.gamepadIndex].values[l[r].inputs[c].value]=0))):"mouse"==l[r].inputs[c].type&&("mouse_up"==l[r].inputs[c].value?(i=g.mouse.mouseDY<0?Math.min(Math.abs(g.mouse.mouseDY)/n,1):0,p=v.mouse.mouseDY<0?Math.min(Math.abs(g.mouse.mouseDY)/n,1):0):"mouse_down"==l[r].inputs[c].value?(i=g.mouse.mouseDY>=0?Math.min(g.mouse.mouseDY/n,1):0,p=v.mouse.mouseDY>=0?Math.min(g.mouse.mouseDY/n,1):0):"mouse_left"==l[r].inputs[c].value?(i=g.mouse.mouseDX<0?Math.min(Math.abs(g.mouse.mouseDX)/n,1):0,p=v.mouse.mouseDX<0?Math.min(Math.abs(g.mouse.mouseDX)/n,1):0):"mouse_right"==l[r].inputs[c].value?(i=g.mouse.mouseDX>=0?Math.min(g.mouse.mouseDX/n,1):0,p=v.mouse.mouseDX>=0?Math.min(g.mouse.mouseDX/n,1):0):(i=g.mouse[l[r].inputs[c].value],p=v.mouse[l[r].inputs[c].value]),s.val=i,s.pressed=!i&&p,s.delta=i-p);return s.val||(s.val=0),s.pressed||(s.pressed=0),s.delta||(s.delta=0),s},inpoot.resetConfigs=function(){c&&inpoot.setPlayers(c),u&&inpoot.setMappings(u)},inpoot.getMappings=function(){var a=t.storage.getObject("inpoot_action_mappings");return JSON.stringify(a)},inpoot.setMappings=function(a){"string"==typeof a&&(a=JSON.parse(a)),u=a,t.storage.setObject("inpoot_action_mappings",a)},inpoot.getPlayers=function(){var a=t.storage.getObject("inpoot_stored_players");return JSON.stringify(a)},inpoot.setPlayers=function(a){"string"==typeof a&&(a=JSON.parse(a)),c=a,t.storage.setObject("inpoot_stored_players",a)},inpoot.getRemoteGamepadConfigs=function(){};var P=function(t){var a=inpoot.gamepads[t],e={buttonToRaw:{button:{},axis:{},axis_dual:{}},rawToButton:{buttons:{},axes:{},axesMap:{}}};if(a){for(var o in a.button)e.buttonToRaw.button[o]=!1;for(var n in a.axis_dual)e.buttonToRaw.axis_dual[n]={x:!1,y:!1};return e}alert("We do not have configurations stored for this type of gamepad:"+t)},X=function(a){var e=d[a];return e||!!(e=P(a))&&(d[a]=e,t.storage.setObject("gamepadmaps",d),e)},E=function(t){return inpoot.gamepads[t]},G=function(){t.storage.setObject("gamepadmaps",d)},R=function(){inpoot.utils.modal.show({template:"inpoot.main-content",data:{},behavior:function(a){var e=t(a.nodes[0]);e.find(".inpoot-main-option.players").click(function(){H()}),e.find(".inpoot-main-option.settings").click(function(){K()}),e.find(".inpoot-main-option.mappings").click(function(){W()})}})},Y=function(){for(var t=A(),a=-1,e=0;e<t.length;e++)a<t[e].id&&(a=t[e].id);return a+1},A=function(a){var e=t.storage.getObject("inpoot_action_mappings");if(e||(e=[],t.storage.setObject("inpoot_action_mappings",e)),void 0===a||null===a)return e;for(var o=0;o<e.length;o++)if(e[o].id==a)return e[o]},F=function(a){for(var e=A(),o=0;o<e.length;o++)e[o].id==a&&(e.splice(o,1),t.storage.setObject("inpoot_action_mappings",e))},$=function(){return t.extend({},s)},z=function(a){T();var e=A(a),o=t.storage.getObject("storedGamepads")||[],n=function(){for(var o=A(),n=0;n<o.length;n++)o[n].id==a&&(o[n]=e,t.storage.setObject("inpoot_action_mappings",o))};"click to edit"==e.extra&&(e.extra="",n()),inpoot.utils.modal.show({template:"inpoot.action_map",data:{actionMap:e,gamepads:o},behavior:function(a){var e=t(a.nodes[0]),i=a.data.actionMap;e.find(".inpoot-top-option").click(W),e.find(".inpoot-main-gamepad-options-message input").inpootEdit({onChange:function(t){i.name=t,n()},defaultText:"New Mapping"});for(var p=[{text:"OFF",value:"false",style:"off",message:"Warning, this will remove all mappings that currently use the gamepad"}],s=0;s<o.length;s++)p.push({text:o[s].displayName,value:o[s].gpadType,style:"on",message:"Switching gamepads will remove all mappings from other gamepads",ifNot:["false"]});inpoot.utils.styledSelect({container:t(".inpoot-input-selector.keyboard"),selected:i.keyboard,options:[{text:"ON",value:"true",style:"on"},{text:"OFF",value:"false",style:"off",message:"Warning, this will remove all mappings that currently use the keyboard"}],callBack:function(t){i.keyboard=t.value,n()}}),inpoot.utils.styledSelect({container:t(".inpoot-input-selector.mouse"),selected:i.mouse,options:[{text:"ON",value:"true",style:"on"},{text:"OFF",value:"false",style:"off",message:"Warning, this will remove all mappings that currently use the mouse"}],callBack:function(t){i.mouse=t.value,n()}}),inpoot.utils.styledSelect({container:t(".inpoot-input-selector.gamepad"),selected:i.gamepad,options:p,callBack:function(t){i.gamepad=t.value,n()}});var d,l=function(t){for(var a=-1,e=0;e<t.length;e++)a<t[e].id&&(a=t[e].id);return a+1},r=function(t,a,e){for(var o=i.mapping[t].inputs,p=-1,s=0;s<o.length;s++)if(o[s].id==a){p=s;break}-1!=p&&(o.splice(p,1),n(),e())},c=function(t,a){for(var e=0;e<t.length;e++)if(t[e].id==a)return t[e]},u=function(a){var e=t(a.nodes[0]),o=a.data,p=e.find(".inpoot-edit-mapping-gather-inputs.gamepad"),s=p.find(".inpoot-edit-mapping-gather-input-list"),d=e.find(".inpoot-edit-mapping-gather-inputs.keyboard").find(".inpoot-edit-mapping-gather-input-list"),l=e.find(".inpoot-edit-mapping-gather-inputs.mouse"),r=l.find(".inpoot-edit-mapping-gather-input-list"),u=o.actionMap,m=o.actionId;t(".inpoot-map-form").addClass("editing"),t(".inpoot-editing-inputs-close").unbind("click").click(function(){t(".inpoot-map-form").removeClass("editing"),v(o.actionId)});for(var f=function(t,a){for(var e=i.mapping[m].inputs,p=o.mapId,s=-1,d=0;d<e.length;d++)if(e[d].id==p){s=d;break}if(-1!=s)for(var l=e[s],r=0;r<l.inputs.length;r++)l.inputs[r].type==t&&l.inputs[r].value==a.value&&(l.inputs.splice(r,1),n())},y=function(a,e){var o="gamepad"==a?s:"mouse"==a?r:d;t.tmpl("inpoot.action_map.action_edit_action_map_item",{name:e.text},{rendered:function(o){var n=t(o.nodes[0]);n.find(".inpoot-x-out").click(function(){f(a,e),n.fadeOut(function(){n.remove()})})}}).appendTo(o)},b=function(t,a,e){u.id;var i=o.mapId;c(u.mapping[m].inputs,i).inputs.push({type:t,text:a.text,value:a.value,buttonType:a.buttonType,subType:a.subType,direction:a.direction}),n(),y(t,a)},x={keyboard:{},gamepad:{}},h={},k=o.actionMap.gamepad,_=function(){for(var a in g.gamepad){var e=g.gamepad[a];if(e.type==k)for(var o in e.values)e.values[o]?x.gamepad[o]=e.values[o]:x.gamepad[o]=0}for(var n in x.gamepad)Math.abs(x.gamepad[n])<=.5&&h.gamepad&&Math.abs(h.gamepad[n])>.5&&b("gamepad",M(k,n,h.gamepad[n]));if(h=t.extend(!0,{},x),u.keyboard&&"false"!=u.keyboard){for(n in x.keyboard)!0!==x.keyboard[n]||g.keyboard[n]||(b("keyboard",{text:inpoot.getKeyboardMap(n),value:n}),delete x.keyboard[n]);for(n in g.keyboard)g.keyboard[n]&&(x.keyboard[n]=!0)}},w=c(u.mapping[m].inputs,o.mapId).inputs,T=0;T<w.length;T++)y(w[T].type,w[T]);if(u.mouse&&"false"!=u.mouse){var I=t(".dumbBox-content");l.find(".inpoot-gather-add-button").click(function(){var t=[{text:"mouse up",value:"mouse_up"},{text:"mouse down",value:"mouse_down"},{text:"mouse left",value:"mouse_left"},{text:"mouse right",value:"mouse_right"},{text:"left button",value:"mouse_button_left"},{text:"middle button",value:"mouse_button_middle"},{text:"right button",value:"mouse_button_right"},{text:"back button",value:"mouse_button_back"},{text:"forward button",value:"mouse_button_forward"},{text:"scroll forward",value:"mouse_scroll_forward"},{text:"scroll back",value:"mouse_scroll_back"}];inpoot.utils.optionBox({title:void 0,container:I,options:t,maxHeight:400,callBack:function(t){b("mouse",t)}})})}if(u.gamepad&&"false"!=u.gamepad){var C=E(u.gamepad),O=[],B=function(t,a,e){O.push({text:t,value:a,data:e})},N=function(t,a){return a[t].name?a[t].name:t};for(var j in C.button)B(N(j,C.button),j,{subType:"button"});for(var S in C.axis_dual)B(N(S,C.axis_dual)+" up",S,{buttonType:"axis_dual",subType:"y",direction:"up"}),B(N(S,C.axis_dual)+" down",S,{buttonType:"axis_dual",subType:"y",direction:"down"}),B(N(S,C.axis_dual)+" left",S,{buttonType:"axis_dual",subType:"x",direction:"left"}),B(N(S,C.axis_dual)+" right",S,{buttonType:"axis_dual",subType:"x",direction:"right"});var D=t(".dumbBox-content");p.find(".inpoot-gather-add-button").click(function(){inpoot.utils.optionBox({title:void 0,container:D,options:O,maxHeight:400,callBack:function(t){b("gamepad",{value:t.value,text:t.text,subType:t.data.subType,buttonType:t.data.buttonType,direction:t.data.direction})}})})}inpoot.utils.poll.setInterval(function(){inpoot.tick(!0),_()},100,"live-mapping")},m=function(a,e){var o=i.mapping[a].inputs,n=(c(o,e),t(".inpoot-map-form-left-hidden-inner")),p=i.mapping[a].descr?i.mapping[a].descr:a;n.find(".inpoot-editing-inputs-title").html(p);var s=0;i.keyboard&&"false"!=i.keyboard&&s++,i.mouse&&"false"!=i.mouse&&s++,i.gamepad&&"false"!=i.gamepad&&s++,t.tmpl("inpoot.action_map.action_edit_mapping",{actionMap:i,actionId:a,mapId:e,inputCount:s},{rendered:u}).appendTo(t(".inpoot-map-form-right-inner").html(""))},v=function(a){inpoot.utils.poll.clear("live-mapping");var e=i.mapping[a],o={actionId:a,descr:e.descr,inputs:e.inputs};t.tmpl("inpoot.action_map.action_edit_action_inputs",o,{rendered:function(e){var o=t(e.nodes[0]),p=e.data,s=function(e){var o=t(e.nodes[0]),n=e.data;o.click(function(){m(a,n.id)}),o.find(".inpoot-x-out").click(function(t){t.preventDefault(),t.stopPropagation(),r(a,n.id,function(){o.fadeOut("fast",function(){o.remove()})})}),o.fadeIn("fast")};o.find(".inpoot-main-gamepad-edit-action-options").click(function(){i.mapping[a].inputs=i.mapping[a].inputs||[];var e=i.mapping[a].inputs,p=l(e);e.push({id:p,inputs:[]}),n(),t.tmpl("inpoot.action_map.action_edit_action_input_hidden",[{id:p,inputs:[]}],{rendered:s}).appendTo(o.find(".inpoot-main-gamepad-edit-action-options-list"))}),t.tmpl("inpoot.action_map.action_edit_action_input",p.inputs||[],{rendered:s}).appendTo(o.find(".inpoot-main-gamepad-edit-action-options-list").html(""))}}).appendTo(t(".inpoot-map-form-right-inner").html(""))},f=function(a,e){d=a,t.tmpl("inpoot.action_map.action_list_item",e,{rendered:function(a){var e=t(a.nodes[0]),o=a.data;e.click(function(){t(".inpoot-edit-action-map-list-group-action").removeClass("selected"),e.addClass("selected"),v(o.actionId)})}}).appendTo(t(".inpoot-map-form-middle-inner").html("")),t(".inpoot-edit-action-map-list-group-action").length>0&&t(t(".inpoot-edit-action-map-list-group-action")[0]).click()};t.tmpl("inpoot.action_map.action_list",function(t){var a={},e=[],o=function(t,o,n){e[a[t]].actions.push({actionId:o,category:t,descr:n.descr||o,inputs:n.inputs})};for(var n in t){var i=t[n];i.category?(void 0===a[i.category]&&(a[i.category]=e.length,e.push({actions:[],name:i.category})),o(i.category,n,i)):(void 0===a.other&&(a.other=e.length,e.push({actions:[],name:"other"})),o("other",n,i))}return e}(i.mapping),{rendered:function(a){var e=t(a.nodes[0]),o=a.data;e.click(function(){t(".inpoot-edit-action-map-list-group").removeClass("selected"),e.addClass("selected"),f(o.name,o.actions)})}}).appendTo(t(".inpoot-map-form-left-inner")),t(".inpoot-edit-action-map-list-group").length>0&&t(t(".inpoot-edit-action-map-list-group")[0]).click()}})},W=function(){var a=function(){var a=A(),e={name:"New Mapping",extra:"click to edit",gamepad:!1,keyboard:!0,mouse:!0,id:Y(),mapping:$()};a.push(e),t.storage.setObject("inpoot_action_mappings",a)},e=function(){var a=t(".inpoot-mappings-list"),e=A();a.html(""),t.tmpl("inpoot.mapping-list",e,{rendered:function(a){var e=t(a.nodes[0]);e.find(".inpoot-mapping-item-delete").click(function(t){t.preventDefault(),t.stopPropagation(),e.find(".inpoot-mapping-item-inputs").stop(!0,!0).hide(),e.find(".inpoot-mapping-item-delete-confirm").stop(!0,!0).fadeIn("fast")}),e.find(".inpoot-mapping-item-delete-confirm-cancel").click(function(t){t.preventDefault(),t.stopPropagation(),e.find(".inpoot-mapping-item-delete-confirm").stop(!0,!0).hide(),e.find(".inpoot-mapping-item-inputs").stop(!0,!0).fadeIn("fast")}),e.find(".inpoot-mapping-item-delete-confirm-okay").click(function(t){t.preventDefault(),t.stopPropagation(),e.slideUp(function(){e.remove(),F(a.data.id),inpoot.utils.modal.expand()})}),e.click(function(){z(a.data.id)})}}).appendTo(a),inpoot.utils.modal.expand()};inpoot.utils.modal.show({template:"inpoot.mappings",data:{},behavior:function(o){var n=t(o.nodes[0]);n.find(".inpoot-top-option").click(R),n.find(".inpoot-message-button").click(function(){a(),e()}),e()}})},U=function(a){var e,o,n,i=function(a){o=a,n=0,inpoot.utils.poll.clear("monitor-callibration"),t(".pressed-now").remove("pressed-now"),s()},p=function(){inpoot.utils.poll.clear("please-stop"),inpoot.utils.poll.clear("single-button-press"),inpoot.utils.poll.clear("continue-monitoring"),t(".inpoot-gamepad-calibrate-gamepad-3d-presskey").stop(!0,!0).hide(),t(".gamepad-button").removeClass("mapped").removeClass("mapping").removeClass("up").removeClass("down").removeClass("right").removeClass("left"),d=!1,o=[],n=0},s=function(){if(n<o.length){var e=o[n],i=inpoot.gamepads[a.gpadType][e.type][e.bid].name||e.bid,p=e.text||"",c=e.style||" ";t(".gamepadclass-"+e.bid).addClass("mapping "+c),t(".inpoot-gamepad-calibrate-gamepad-3d-presskey").removeClass("thanks").find(".inpoot-gamepad-calibrate-gamepad-3d-presskey-text").html("PRESS <span class='inpoot-gamepad-presskey-bold'> "+i+" "+p+" </span>"),t(".inpoot-gamepad-calibrate-gamepad-3d-presskey").stop(!0,!0).show(),l(function(o){var i=X(a.gpadType);"button"==e.type?i.buttonToRaw[o.type][e.bid]=o.number:"axis_dual"==e.type&&("up"==e.style||"down"==e.style?(i.buttonToRaw.axis_dual[e.bid].y=o.number,i.rawToButton.axesMap[e.bid+"down"]={bid:e.bid,index:o.number,subType:"y",direction:"down"},i.rawToButton.axesMap[e.bid+"up"]={bid:e.bid,index:o.number,subType:"y",direction:"up"}):(i.buttonToRaw.axis_dual[e.bid].x=o.number,i.rawToButton.axesMap[e.bid+"left"]={bid:e.bid,index:o.number,subType:"x",direction:"left"},i.rawToButton.axesMap[e.bid+"right"]={bid:e.bid,index:o.number,subType:"x",direction:"right"}));var p=!1,l="button"==o.type?"buttons":"axes";"up"==e.style||"down"==e.style?p="y":"left"!=e.style&&"right"!=e.style||(p="x"),i.rawToButton[l][o.number]={type:e.type,bid:e.bid,subType:p},G(),t(".gamepadclass-"+e.bid).addClass("mapped"),t(".inpoot-gamepad-calibrate-gamepad-3d-presskey").addClass("thanks"),t(".inpoot-gamepad-calibrate-gamepad-3d-presskey").stop(!0,!0).fadeOut(500,function(){t(".gamepadclass-"+e.bid).removeClass("mapped").removeClass("mapping").removeClass(c),n++,inpoot.utils.poll.setTimeout(function(){d=!1,s()},300,"please-stop")})})}else t(".inpoot-gamepad-calibrate-gamepad-3d-presskey").removeClass("thanks").stop(!0,!0).hide(),r()},d=!1,l=function(t){for(var e=w(),o=[],n=0;n<e.length;n++)e[n].gamepad.gpadType==a.gpadType&&o.push(e[n]);inpoot.utils.poll.setInterval(function(){for(var a=_(),e=0;e<o.length;e++){var n=a[o[e].gamepadIndex];if(n){for(var i=0;i<n.buttons.length;i++)n.buttons[i].value>.5&&!d&&(d=!0,inpoot.utils.poll.clear("single-button-press"),console.log("rawDog.buttons",n.buttons[i]),t({type:"button",number:i,value:n.buttons[i]}));for(var p=0;p<n.axes.length;p++)Math.abs(n.axes[p])>.7&&!d&&(d=!0,inpoot.utils.poll.clear("single-button-press"),console.log("rawDog.axes",n.axes[p]),t({type:"axis",number:p,value:n.axes[p]}))}}},50,"single-button-press")},r=function(){var e=X(a.gpadType);inpoot.gamepads[a.gpadType];if(e){var o=function(){inpoot.utils.poll.setTimeout(function(){d=!1,n()},100,"continue-monitoring")},n=function(){l(function(a){t(".pressed").removeClass("pressed");var n="button"==a.type?"buttons":"axes",i=e.rawToButton[n][a.number];void 0===i&&console.log(e.rawToButton,e.rawToButton[n],n,a.number);var p=" ";i&&(i.subType&&("y"==i.subType?p=a.value>0?"down":"up":"x"==i.subType&&(p=a.value>0?"right":"left")),t(".gamepad-button.gamepadclass-"+i.bid).addClass("pressed "+p),inpoot.utils.poll.setTimeout(function(){t(".gamepad-button.gamepadclass-"+i.bid).removeClass("pressed").removeClass(p)},350)),o()})};n()}};inpoot.utils.modal.show({template:"inpoot.gamepad-calibrate",data:a,behavior:function(o){for(var n=inpoot.gamepads[a.gpadType],s=w(),d=0;d<s.length;d++)s[d].gamepad.gpadType!=a.gpadType||s[d];inpoot.utils.poll.setTimeout(function(){var a,i=t(o.nodes[0]);e=i,i.find(".inpoot-top-option").click(function(){K()});for(var p in n.button){var s=n.button[p];a=s.face||"front",t(".inpoot-gamepad-calibrate-face."+a).append('<span class="gamepad-button gamepadclass-'+p+" "+(s.style||"")+" "+(s.bclass||"")+' " style="left:'+s.x+"%; top:"+s.y+'%;"><span class="gamepad-button-inner">'+(s.text||"&nbsp;")+'<span class="gamepad-button-inner-dec"></span></span></span>')}for(var d in n.axis_dual){var l=n.axis_dual[d];a=l.face||"front",t(".inpoot-gamepad-calibrate-face."+a).append('<span class="gamepad-button gamepadclass-'+d+" "+(l.style||"")+" "+(l.bclass||"")+' " style="left:'+l.x+"%; top:"+l.y+'%;"><span class="gamepad-button-inner">'+(l.text||"&nbsp;")+'<span class="gamepad-button-inner-dec"></span></span></span>')}t(".inpoot-gamepad-calibrate-layout").fadeIn();var c=t(".inpoot-gamepad-calibrate-gamepad-3d-holder");c.addClass("turned"),inpoot.utils.poll.setInterval(function(){c.hasClass("turned")?c.removeClass("turned"):c.addClass("turned")},4e3,"gpad-rotation"),r()},300,"gpad-buttons");n=inpoot.gamepads[a.gpadType];t(".inpoot-gamepad-calibrate-panel-button.all").click(function(){p();var t=[],a=function(a,e,o,n){t.push({type:e,bid:a,style:o,text:n})};for(var e in n.button)a(e,"button");for(var o in n.axis_dual)a(o,"axis_dual","up","up"),a(o,"axis_dual","down","down"),a(o,"axis_dual","left","left"),a(o,"axis_dual","right","right");i(t)}),t(".inpoot-gamepad-calibrate-gamepad-3d-presskey .inpoot-x-out").click(function(){p(),r()});var l=function(a,e,o){var n=e.name?e.name:a,s=t('<div class="button-configure">'+n+"</div>");s.hover(function(){t(".gamepadclass-"+a).addClass("pressed")},function(){t(".gamepadclass-"+a).removeClass("pressed")}),s.click(function(){p(),i("axis_dual"!=o?[{type:o,bid:a}]:[{type:o,bid:a,style:"up",text:"up"},{type:o,bid:a,style:"down",text:"down"},{type:o,bid:a,style:"left",text:"left"},{type:o,bid:a,style:"right",text:"right"}])}),t(".inpoot-gamepad-calibrate-panel-inner-content").append(s)};for(var c in n.button)l(c,n.button[c],"button");for(var u in n.axis_dual)l(u,n.axis_dual[u],"axis_dual")}})},K=function(){var a,e=[];inpoot.utils.modal.show({template:"inpoot.gamepad-content",data:{},behavior:function(e){var o=t(e.nodes[0]);a=o,o.find(".inpoot-top-option").click(function(){R()}),o.find(".inpoot-help").toggle(function(){t(".inpoot-main-gamepad-options-summary").stop(!0,!0).slideDown(function(){inpoot.utils.modal.expand()})},function(){t(".inpoot-main-gamepad-options-summary").stop(!0,!0).slideUp(function(){inpoot.utils.modal.expand()})})}});p.length;var o=function(a){t(a.nodes[0]).click(function(){t(this).hasClass("active")&&U(a.data)})},n=function(e){a.find(".inpoot-gamepad-list").html(""),t.tmpl("inpoot.gamepad-gamepad",{gamepads:e,gamepadPP:o}).appendTo(a.find(".inpoot-gamepad-list"))};n(),inpoot.utils.poll.setInterval(function(){var a=[];p=w();for(var o=t.storage.getObject("storedGamepads")||[],i=0;i<o.length;i++)a.push({id:o[i].id,displayName:o[i].displayName,gpadType:o[i].gpadType,active:!1});for(var s=0;s<p.length;s++){for(var d=!1,l=0;l<a.length;l++)a[l].id==p[s].gamepad.id&&(a[l].active=!0,d=!0);d||(a.push({id:p[s].gamepad.id,displayName:p[s].gamepad.displayName,active:!0,gpadType:p[s].gamepad.gpadType}),o.push({id:p[s].gamepad.id,displayName:p[s].gamepad.displayName,gpadType:p[s].gamepad.gpadType}),t.storage.setObject("storedGamepads",o))}var r=!1;if(a.length!=e.length&&(r=!0),!r){for(var c=0,u=0;u<a.length;u++)for(var m=0;m<e.length;m++)e[m].id==a[u].id&&e[m].active==a[u].active&&c++;c!=a.length&&(r=!0)}r&&(n(a),inpoot.utils.modal.expand()),e=a},200)},H=function(){var a,e=function(a){t.storage.setObject("inpoot_stored_players",a)},o=function(t){var a=inpoot.gamepads["XBOX 360"].axis_dual,e=[];for(var o in a)a.hasOwnProperty(o)&&e.push({axisName:o,axisTitle:a[o].name,axisType:"y"});return e},n=function(a,o,n){for(var i=t.storage.getObject("inpoot_stored_players")||[],p=-1,s=0;s<i.length;s++)i[s].number==a&&(p=s);-1!=p&&(i[p]=o,e(i),n&&n())},i=function(a){for(var e=t.storage.getObject("inpoot_action_mappings")||[],o=0;o<e.length;o++)if(e[o].id===a)return e[o];return!1},p=function(a){var o=t.storage.getObject("inpoot_stored_players");for(var n in o)if(o[n].number==a.number)return o[n]=a,void e(o)},s=function(){var o=t.storage.getObject("inpoot_stored_players")||[];inpoot.players=[];for(var n=0;n<m;n++){for(var p=-1,s=0;s<o.length;s++)o[s].number==n+1&&(p=s);if(-1!=p){var l=i(o[p].actionMapId);l&&(o[p].title=l.name,o[p].gamepad=l.gamepad,o[p].keyboard=l.keyboard,o[p].mouse=l.mouse),inpoot.players.push(o[p])}else inpoot.players.push({number:n+1,title:!1,actionMapId:!1,keyboard:!1,mouse:!1,gamepad:!1,options:{},gamepadIndex:!1})}e(inpoot.players),t.tmpl("inpoot.player",inpoot.players,{rendered:d}).appendTo(a.find(".inpoot-players-list").html(""))},d=function(a){var e=t(a.nodes[0]);if(!1===a.data.actionMapId&&e.addClass("player-error"),e.find(".inpoot-player-actionmap").click(function(){var e=[],o=t.storage.getObject("inpoot_action_mappings");e.push({text:"[ NONE ]",value:!1,data:{name:!1,gamepad:!1,mouse:!0,keyboard:!0,id:!1}});for(var i=0;i<o.length;i++){var p=o[i].name;e.push({text:p,value:o[i].name,data:o[i]})}var d=t(".dumbBox-content");inpoot.utils.optionBox({title:"Select action mapping for this player",container:d,options:e,callBack:function(t){a.data.title=t.data.name,a.data.actionMapId=t.data.id,a.data.gamepad=t.data.gamepad,a.data.keyboard=t.data.keyboard,a.data.mouse=t.data.mouse,n(a.data.number,a.data,s)}})}),a.data.gamepad){var i=_();!1!==a.data.options.gpadIndex&&i[a.data.options.gpadIndex]&&i[a.data.options.gpadIndex].gpadType==a.data.gamepad?e.find(".inpoot-player-gamepad-index").html("Gamepad Slot "+(parseInt(a.data.options.gpadIndex,10)+1)):(a.data.options.gpadIndex=!1,p(a.data),e.find(".inpoot-player-gamepad-index").html("select gamepad"),e.addClass("player-error"))}e.find(".inpoot-player-gamepad-index").click(function(){for(var o=[],n=!1,s=0;s<4;s++)if(i[s]){var d=a.data.gamepad!=i[s].gpadType;d||(n=!0),o.push({value:s,text:"Gamepad Slot "+(s+1)+" : "+i[s].gpadType,disabled:d})}else o.push({value:s,text:"Gamepad Slot "+(s+1)+" : EMPTY",disabled:!0});var l=t(".dumbBox-content"),r=!n&&"Could not detect gamepads of this type. Make sure your ("+a.data.gamepad+") gamepad is on and press buttons to activate it.";inpoot.utils.optionBox({title:r,container:l,options:o,callBack:function(t){a.data.options.gpadIndex=t.value,e.find(".inpoot-player-gamepad-index").html("Gamepad Slot "+(parseInt(a.data.options.gpadIndex,10)+1)),e.removeClass("player-error"),p(a.data)}})});e.find(".inpoot-player-options-button.options").toggle(function(){t(this).html("close");var n=e.find(".inpoot-player-options");n.html("");var i=0;if(a.data.gamepad&&"false"!=a.data.gamepad){for(var s=o(a.data.gamepad),d=0;d<s.length;d++){var l=s[d].axisName;a.data.options.axes=a.data.options.axes||{},a.data.options.axes[l]=void 0!==a.data.options.axes[l]&&a.data.options.axes[l],s[d].axisInverted=a.data.options.axes[l]}s.length>0&&(i++,t.tmpl("inpoot.player-options-title",{title:"Invert Gamepad Y Axes"}).appendTo(n),t.tmpl("inpoot.player-invert-axis",s,{rendered:function(e){var o=t(e.nodes[0]),n=e.data,i=e.data.axisName;o.click(function(){n.axisInverted?(n.axisInverted=!1,t(this).find(".inpoot-player-invert-axis-value").html("NORMAL"),t(this).removeClass("inverted-true").addClass("inverted-false")):(n.axisInverted=!0,t(this).find(".inpoot-player-invert-axis-value").html("INVERTED"),t(this).removeClass("inverted-false").addClass("inverted-true")),a.data.options.axes[i]=n.axisInverted,p(a.data)})}}).appendTo(n))}0===i&&t.tmpl("inpoot.player-options-title",{title:"No additional options for this player"}).appendTo(n),n.stop(!0,!0).show(0,inpoot.utils.modal.expand)},function(){t(this).html("options"),e.find(".inpoot-player-options").stop(!0,!0).hide(0,inpoot.utils.modal.expand)})};inpoot.utils.modal.show({template:"inpoot.player-content",data:{},behavior:function(e){var o=t(e.nodes[0]);a=o,o.find(".inpoot-top-option").click(function(){R()}),s()}});var l=w().length;inpoot.utils.poll.setInterval(function(){var a=w();a.length!=l&&(l=a.length,s(),t(".inpoot-option-box-wrapper").remove(),t(".inpoot-option-box-screen").remove())},50,"player-gamepad-scanning")};inpoot.openMenu=function(){l=!0,R()},inpoot.utils={truncate:function(t,a){return t.length>a?t.substr(0,a-3)+"...":t},optionBox:function(a){var e={};e.container=a.container,e.options=a,e.close=function(){t(".inpoot-option-box-wrapper").remove(),t(".inpoot-option-box-screen").remove(),e.options.onClose&&e.options.onClose()},e.close();var o=t('<div class="inpoot-option-box-screen"></div>'),n=t('<span class="inpoot-option-box-wrapper"></span>'),i=t('<div class="inpoot-option-box"></div>'),p=t('<div class="inpoot-option-box-content"></div>'),s=t('<div class="inpoot-option-box-close">cancel</div>'),d=t(e.options.title?'<div class="inpoot-option-box-title">'+e.options.title+"</div>":"<div></div>");n.append(i),i.append(s),i.append(d),i.append(p),e.options.maxHeight&&p.css("max-height",e.options.maxHeight+"px").css("overflow-y","auto"),s.click(function(){e.close()});for(var l=0;l<e.options.options.length;l++){var r=e.options.options[l].disabled?" disabled ":"",c=t('<div class="inpoot-option-box-option '+r+'"><a href="#">'+e.options.options[l].text+"</a></div>");c.click(function(t){return function(a){a.preventDefault(),t.disabled||(e.close(),e.options.callBack.apply(e,[t]))}}(e.options.options[l])),c.appendTo(p)}t(".dumbBoxWrap .vertical-offset").append(n),o.appendTo(t(".dumbBoxWrap .vertical-offset")),i.stop(!0,!0).fadeIn("fast")},styledSelect:function(a){var e={},o=a.callBack;e.container=a.container,e.options=a.options;for(var n={},i=t(".dumbBox-content"),p=e.options[0],s=0;s<e.options.length;s++)e.options[s].value==a.selected&&(p=e.options[s]);var d=t('<span class="styled-select-container"></span>'),l=t('<span class="styled-select-value"></span>'),r=t('<span class="styled-select-options"></span>'),c=t('<span class="style-select-left-image"></span>'),u=t('<span class="style-select-right-image"></span>');return d.append(c),d.append(l),d.append(u),d.append(r),e.container.append(d),e.setValue=function(t){for(var a=0;a<e.options.length;a++)e.options[a].value==t&&(p=e.options[a]);l.html(inpoot.utils.truncate(p.text,25)),l.removeClass().addClass("styled-select-value"),p.style&&l.addClass(p.style)},e.getValue=function(){return p.value},e.container.click(function(){n=inpoot.utils.optionBox({title:void 0,container:i,options:e.options,callBack:function(t){for(var a,s=function(){p=t,o(t),d.removeClass("choosing"),d.find(".styled-select-value").removeClass().addClass("styled-select-value").addClass(t.style).html(inpoot.utils.truncate(t.text,25))},l=0;l<e.options.length;l++)if(e.options[l].value==t.value){a=e.options[l];break}var r=t.ifNot&&-1!=t.ifNot.indexOf(p.value);a.message&&t.value!=p.value&&!r?n=inpoot.utils.optionBox({title:a.message,container:i,options:[{text:"CANCEL",value:"cancel"},{text:"OK",value:"okay"}],callBack:function(t){"okay"==t.value&&s()}}):s()}})}),e.setValue(p.value),e},modal:{showing:!1,buttonPP:function(a){t(a.nodes[0]).find("a").click(function(t){t.preventDefault(),a.data.click&&a.data.click(a.data)})},expand:function(){setTimeout(function(){var a=t(".dumbBox-content"),e=t(".dumbBox"),o=a.height(),n=a.width();e.css("height",o),e.css("width",n),setTimeout(function(){a.stop(!0,!0).fadeIn(200)},200)},50)},newContent:function(a,e){var o=this,n=a.behavior?a.behavior:t.noop,i=a.data?a.data:{},p=t(".dumbBox-content"),s=(t(".dumbBox"),function(){p.stop(!0,!0).hide(),p.html(""),t.tmpl(a.template,i,{rendered:n}).appendTo(p),o.expand()});e?s():p.stop(!0,!0).fadeOut(500,s)},show:function(a){var e=this;if(inpoot.utils.poll.purge(),inpoot.utils.modal.showing)e.newContent(a,!0);else{t.tmpl("inpoot.modal").appendTo(t("body"));var o=t(".dumbBoxWrap"),n=t(".dumbBoxOverlay"),i=t(".dumbBox");t(".dumbBox-content"),t(".dumbBox-buttons");o.show(),n.stop(!0,!0).fadeIn(100,function(){i.stop(!0,!0).fadeIn(200,function(){e.newContent(a,!0),inpoot.utils.modal.showing=!0})}),t(".vertical-offset").click(function(a){t(a.target).hasClass("vertical-offset")&&e.hide()}),n.click(e.hide)}},hide:function(){inpoot.utils.poll.purge(),inpoot.utils.modal.showing=!1;t(".dumbBoxWrap");var a=t(".dumbBoxOverlay"),e=t(".dumbBox"),o=t(".dumbBox-content"),n=t(".dumbBox-buttons");e.stop(!0,!0).hide(),a.stop(!0,!0).fadeOut(200,function(){o.html(""),n.html(""),t(".dumbBoxWrap").remove()}),l=!1,inpoot.refreshParams()}},poll:{pollId:0,repository:{},getPollId:function(){return"poll-"+ ++this.pollId},clear:function(t){var a=this.repository[t];a&&("timeout"==a.type?clearTimeout(a.pollObj):clearInterval(a.pollObj),delete this.repository[t])},purge:function(){for(var t in this.repository){var a=this.repository[t];"timeout"==a.type?clearTimeout(a.pollObj):clearInterval(a.pollObj),delete this.repository[t]}},setTimeout:function(t,a,e){e=e||this.getPollId();var o={type:"timeout",pollObj:setTimeout(t,a)};this.repository[e]=o},setInterval:function(t,a,e){e=e||this.getPollId();var o={type:"interval",pollObj:setInterval(t,a)};this.repository[e]=o}}},t.template("inpoot.main-content",['<div class="inpoot-main-wrapper">','<div class="inpoot-main-menu">','<div class="inpoot-main-option players">','<span class="inpoot-main-options-image"><span class="inpoot-input-icon players"></span></span>','<span class="inpoot-main-options-title">Players</span>',"</div>",'<div class="inpoot-main-option mappings">','<span class="inpoot-main-options-image"><span class="inpoot-input-icon gamepad"></span></span>','<span class="inpoot-main-options-title">Mappings</span>',"</div>",'<div class="inpoot-main-option settings">','<span class="inpoot-main-options-image"><span class="inpoot-input-icon settings"></span></span>','<span class="inpoot-main-options-title">calibrate</span>',"</div>","</div>","</div>"].join("")),t.template("inpoot.action_map",['<div class="inpoot-edit-action-map-wrapper">','<div class="inpoot-top">','<span class="inpoot-top-title">',"Edit Action Map","</span>",'<span class="inpoot-top-options">','<span class="inpoot-top-option">back</span>',"</span>","</div>",'<div class="inpoot-main-gamepad-options-message inpoot-no-select">','<div class="inpoot-options-left">','<input type="text" value="${actionMap.name}" id="inpoot-action-edit-name" size="16"/>',"</div>",'<div class="inpoot-options-right">','<div class="inpoot-input-selector keyboard">',"</div>",'<div class="inpoot-input-selector mouse">',"</div>",'<div class="inpoot-input-selector gamepad">',"</div>","</div>",'<div class="inpoot-options-clear"></div>',"</div>",'<div class="inpoot-map-form">','<div class="inpoot-map-form-left"><div class="inpoot-map-form-left-inner"></div></div>','<div class="inpoot-map-form-middle"><div class="inpoot-map-form-middle-inner"></div></div>','<div class="inpoot-map-form-left-hidden"><div class="inpoot-map-form-left-hidden-inner">','<div class="inpoot-editing-inputs-title"></div>','<div class="inpoot-editing-inputs-close"><div class="inpoot-close-edit-mapping">CLOSE</div></div>',"</div></div>",'<div class="inpoot-map-form-right"><div class="inpoot-map-form-right-inner"></div></div>',"</div>","</div>"].join("")),t.template("inpoot.action_map.action_list",['<div class="inpoot-edit-action-map-list-group">','<div class="inpoot-edit-action-map-list-group-name">${name}<span class="inpoot-selected-arrow"></span></div>',"</div>"].join("")),t.template("inpoot.action_map.action_list_item",['<div class="inpoot-edit-action-map-list-group-action">{{if (actionId != descr && descr != undefined) }} ${inpoot.utils.truncate(descr, 22)} {{else}} ${inpoot.utils.truncate(actionId, 22)} {{/if}}<span class="inpoot-selected-arrow"></span></div>'].join("")),t.template("inpoot.action_map.action_list_mappings",['<div class="inpoot-edit-action-map-list-mappings">',"list-of-mappings","</div>"].join("")),t.template("inpoot.action_map.action_edit_mapping",['<div class="inpoot-edit-action-map-edit_mapping input-count-${inputCount}">','{{if (actionMap.keyboard && actionMap.keyboard != "false")}}','<div class="inpoot-edit-mapping-gather-inputs keyboard">','<div class="inpoot-edit-mapping-gather-title inpoot-input-icon-xsmall-container"><span class="inpoot-input-icon-xsmall"></span>KEYBOARD  <span class="inpoot-gather-add-button">PRESS KEYS</span></div>','<div class="inpoot-edit-mapping-gather-input-list">',"</div>","</div>","{{/if}}",'{{if (actionMap.gamepad && actionMap.gamepad != "false")}}','<div class="inpoot-edit-mapping-gather-inputs gamepad">','<div class="inpoot-edit-mapping-gather-title inpoot-input-icon-xsmall-container"><span class="inpoot-input-icon-xsmall"></span>GAMEPAD <span class="inpoot-gather-add-button active">CLICK -or- PRESS BUTTONS</span></div>','<div class="inpoot-edit-mapping-gather-input-list"></div>',"</div>","{{/if}}",'{{if (actionMap.mouse && actionMap.mouse != "false")}}','<div class="inpoot-edit-mapping-gather-inputs mouse">','<div class="inpoot-edit-mapping-gather-title inpoot-input-icon-xsmall-container"><span class="inpoot-input-icon-xsmall"></span>MOUSE <span class="inpoot-gather-add-button active">CLICK to add mouse input</span></div>','<div class="inpoot-edit-mapping-gather-input-list"></div>',"</div>","{{/if}}","</div>"].join("")),t.template("inpoot.action_map.action_edit_action_map_item",['<div class="inpoot-edit-mapping-gather-input-list-item"><span class="inpoot-x-out"></span>${name}</div>'].join("")),t.template("inpoot.action_map.action_edit_action_inputs",["<div>",'<div class="inpoot-edit-action-top"><span class="inpoot-edit-action-title">${descr}</span> {{if actionId != descr}}<span class="inpoot-edit-action-title-actionid"> : ${actionId} </span>{{/if}}</div>','<div class="inpoot-main-gamepad-edit-action-options"> [+] New Input Combination </div>','<div class="inpoot-main-gamepad-edit-action-options-list"></div>',"</div>"].join("")),t.template("inpoot.action_map.action_edit_action_input",['<div class="inpoot-edit-action-keys">','<div class="inpoot-x-out"></div>','<div class="inpoot-edit-action-keys-list">',"{{if inputs.length == 0}}",'<span class="inpoot-edit-action-keys-list-and edit">(click to edit)</span> ',"{{else}}",'{{tmpl(inputs) "inpoot.action_map.action_edit_action_input_listing"}}',"{{/if}}","</div>","</div>"].join("")),t.template("inpoot.action_map.action_edit_action_input_listing",['<span class="inpoot-input-item ${type}"><span class="inpoot-input-icon-xsmall-container"><span class="inpoot-input-listing-title-type inpoot-input-icon-xsmall">&nbsp;</span><span class="inpoot-input-listing-title">${text}</span></span></span>'].join("")),t.template("inpoot.action_map.action_edit_action_input_hidden",['<div class="inpoot-edit-action-keys hide-action-inputs">','<div class="inpoot-x-out"></div>','<div class="inpoot-edit-action-keys-list">{{if inputs.length == 0}} <span class="inpoot-edit-action-keys-list-and edit">(click to edit)</span> {{else}} yo {{/if}}</div>',"</div>"].join("")),t.template("inpoot.mappings",['<div class="inpoot-mappings-wrapper">','<div class="inpoot-top">','<span class="inpoot-top-title">',"view and edit stored input to action maps","</span>",'<span class="inpoot-top-options">','<span class="inpoot-top-option">back</span>',"</span>","</div>",'<div class="inpoot-main-gamepad-options-message">','<span class="inpoot-message-button">[+] Create New Mapping</span>',"</div>",'<div class="inpoot-mappings-list"></div>',"</div>"].join("")),t.template("inpoot.mapping-list",['<div class="inpoot-mapping-item">','<span class="inpoot-mapping-item-left">','<span class="inpoot-mapping-item-delete">&nbsp;</span>','<span class="inpoot-mapping-item-name">${name} <span class="inpoot-parens">{{if extra}}(${extra}){{/if}}</span></span>',"</span>",'<span class="inpoot-mapping-item-delete-confirm">','<span class="inpoot-mapping-item-delete-confirm-okay inpoot-mapping-item-delete-confirm-button">Delete</span>','<span class="inpoot-mapping-item-delete-confirm-cancel inpoot-mapping-item-delete-confirm-button">Cancel</span>',"</span>",'<span class="inpoot-mapping-item-inputs">','{{if keyboard && keyboard != "false"}}','<span class="inpoot-mapping-item-inputs-input keyboard">&nbsp;</span>',"{{/if}}",'{{if gamepad && gamepad != "false"}}','<span class="inpoot-mapping-item-inputs-input gamepad">&nbsp;</span>',"{{/if}}",'{{if mouse && mouse != "false"}}','<span class="inpoot-mapping-item-inputs-input mouse">&nbsp;</span>',"{{/if}}","</span>","</div>"].join("")),t.template("inpoot.gamepad-calibrate",['<div class="inpoot-gamepad-calibrate-wrapper">','<div class="inpoot-top">','<span class="inpoot-top-title">','press buttons to verify the <span class="inpoot-top-highlight">${gpadType}</span> gamepad\'s configuration',"</span>",'<span class="inpoot-top-options">','<span class="inpoot-top-option">back</span>',"</span>","</div>",'<div class="inpoot-gamepad-calibrate-content">','<div class="inpoot-gamepad-calibrate-layout" style="display:none;">','<div class="inpoot-gamepad-calibrate-gamepad-3d-holder">','<div class="inpoot-gamepad-calibrate-face top"></div>','<div class="inpoot-gamepad-calibrate-face bottom"></div>','<div class="inpoot-gamepad-calibrate-face left"></div>','<div class="inpoot-gamepad-calibrate-face right"></div>','<div class="inpoot-gamepad-calibrate-face front"></div>','<div class="inpoot-gamepad-calibrate-face back"></div>',"</div>",'<div class="inpoot-gamepad-calibrate-gamepad-3d-presskey">','<div class="inpoot-gamepad-calibrate-gamepad-3d-presskey-text"></div>','<div class="inpoot-x-out"></div>',"</div>","</div>",'<div class="inpoot-gamepad-calibrate-panel">','<div class="inpoot-gamepad-calibrate-panel-inner">','<div class="inpoot-gamepad-calibrate-panel-button all">Click to configure all buttons</div>','<div class="inpoot-gamepad-calibrate-panel-inner-content">',"</div>","</div>","</div>","</div>","</div>"].join("")),t.template("inpoot.gamepad-content",['<div class="inpoot-gamepad-wrapper">','<div class="inpoot-top with-icon">','<span class="inpoot-help"></span>','<span class="inpoot-top-title">',"calibrate different gamepad types","</span>",'<span class="inpoot-top-options">','<span class="inpoot-top-option">back</span>',"</span>","</div>",'<div class="inpoot-gamepad-list"></div>',"</div>"].join("")),t.template("inpoot.gamepad-gamepad",['<div class="inpoot-main-gamepad-options-summary">',"Verify that your gamepads' buttons are configured correctly. </br>Not right? Click and edit each type of gamepads' configurations.","</div>",'<div class="inpoot-main-gamepad-options-message">',"Hold down keys on your gamepad to load / calibrate gamepads","</div>","{{if gamepads}}",'{{tmpl(gamepads, {rendered:gamepadPP}) "inpoot.gamepad-gamepad-indy"}}',"{{/if}}"].join("")),t.template("inpoot.gamepad-gamepad-indy",['<div class="inpoot-main-gamepad-option {{if active}}active{{/if}}">','<span class="inpoot-gamepad-option-left">','<span class="inpoot-input-icon gamepad"></span>',"</span>",'<span class="inpoot-gamepad-option-right">',"${displayName}","</br>",'<span class="inpoot-gamepad-option-subinfo">',"{{if active}}","Click to calibrate this type of gamepad","{{else}}","To calibrate, ensure your gamepad is on. Hit keys to activate it.","{{/if}}","</span>","</span>",'<span class="inpoot-status-bar"></span>',"</div>"].join("")),t.template("inpoot.player-content",['<div class="inpoot-player-wrapper">','<div class="inpoot-top">','<span class="inpoot-top-title">edit player mappings and options</span>','<span class="inpoot-top-options">','<span class="inpoot-top-option">back</span>',"</span>","</div>",'<div class="inpoot-players-list">',"</div>","</div>"].join("")),t.template("inpoot.player",['<div class="inpoot-player inpoot-no-select">','<div class="inpoot-player-info">','<div class="inpoot-player-left">','<div class="inpoot-player-title">','<span class="inpoot-player-icon  inpoot-mapping-item-inputs-input players"></span>','<span class="inpoot-player-number">Player ${number}</span>',"</div>","</div>",'<div class="inpoot-player-right">','<span class="inpoot-player-options-button options inpoot-gather-add-button active">',"options","</span>",'<span class="inpoot-player-actionmap inpoot-gather-add-button active">',"{{if title}}",'<span class="inpoot-player-actionmap-title">${title}</span>','<span class="inpoot-player-input-types">','{{if keyboard && keyboard != "false"}}','<span class="keyboard"><span class="inpoot-input-icon-xsmall"></span></span>',"{{/if}}",'{{if mouse && mouse != "false"}}','<span class="mouse"><span class="inpoot-input-icon-xsmall"></span></span>',"{{/if}}",'{{if gamepad && gamepad != "false"}}','<span class="gamepad"><span class="inpoot-input-icon-xsmall"></span></span>',"{{/if}}","</span>","{{else}}","( click to set action mapping )","{{/if}}","</span>",'{{if gamepad && gamepad != "false"}}','<span class="inpoot-player-options-button inpoot-gather-add-button active inpoot-player-gamepad-index">gpad</span>',"{{/if}}","</div>","</div>",'<div class="inpoot-player-options"></div>',"</div>"].join("")),t.template("inpoot.player-invert-axis",['<span class="inpoot-player-invert-axis inverted-${axisInverted}">','<span class="inpoot-player-invert-axis-name">${axisTitle}</span>','<span class="inpoot-player-invert-axis-value">',"{{if axisInverted}}","INVERTED","{{else}}","NORMAL","{{/if}}","</span>","</span>"].join("")),t.template("inpoot.player-options-title",['<div class="inpoot-player-options-title">${title}</div>'].join("")),t.template("inpoot.modal",['<div class="dumbBoxWrap">','<div class="dumbBoxOverlay">',"&nbsp;","</div>",'<div class="vertical-offset">','<div class="dumbBox">','<div class="dumbBox-content-wrapper">','<div class="dumbBox-content"></div>',"</div>","</div>","</div>","</div>"].join("")),t.template("inpoot.modal.buttons",['<span class="dumbBox-button">','<a href="#">${title}</a>',"</span>"].join(""))}(jQuery),jQuery.storage=window.localStorage,Storage.prototype.setObject=function(t,a){this.setItem(t,JSON.stringify(a))},Storage.prototype.getObject=function(t){var a=this.getItem(t);return a&&JSON.parse(a)},Storage.prototype.removeObject=function(t){var a=this.removeItem(t);return a&&JSON.parse(a)},function(t){var a={init:function(a){var e=t(this[0]),o={onChange:t.noop,defaultText:""},n=t.extend({},o,a);return e.data("plugin-options",n),e.focus(function(){t(this).val()==n.defaultText&&t(this).val("")}),e.keyup(function(a){13!=a.which&&27!=a.which||t(this).blur()}),e.blur(function(){""===t.trim(t(this).val())&&t(this).val(n.defaultText),n.onChange(t(this).val())}),e}};t.fn.inpootEdit=function(t){if(0!==this.length)return a[t]?a[t].apply(this,Array.prototype.slice.call(arguments,1)):a.init.apply(this,arguments)}}(jQuery),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){"use strict";if(null===this)throw new TypeError;var a=new Object(this),e=a.length>>>0;if(0===e)return-1;var o=0;if(arguments.length>0&&((o=Number(arguments[1]))!=o?o=0:0!==o&&o!=1/0&&o!=-1/0&&(o=(o>0||-1)*Math.floor(Math.abs(o)))),o>=e)return-1;for(var n=o>=0?o:Math.max(e-Math.abs(o),0);n<e;n++)if(n in a&&a[n]===t)return n;return-1}),function(t){"use strict";t.gamepads={},t.gamepads["XBOX 360"]={displayName:"XBOX 360 Controller",idMatches:[["45e","28e"],["45e","2a1"],["045e","02e0"],["XInput","GAMEPAD"]],button:{dpadUp:{name:"dpad up",style:"dpadUp",x:30,y:45},dpadDown:{name:"dpad down",style:"dpadDown",x:30,y:65},dpadLeft:{name:"dpad left",style:"dpadLeft",x:25,y:55},dpadRight:{name:"dpad right",style:"dpadRight",x:35,y:55},start:{style:"round_small",text:"s",bclass:"xbox-white",x:60,y:20},back:{style:"round_small",text:"b",bclass:"xbox-white",x:40,y:20},on:{style:"round_large",text:"ON",bclass:"xbox-center",x:50,y:20},A:{style:"round",text:"A",bclass:"xbox-a",x:80,y:30},B:{style:"round",text:"B",bclass:"xbox-b",x:86,y:20},X:{style:"round",text:"X",bclass:"xbox-x",x:74,y:20},Y:{style:"round",text:"Y",bclass:"xbox-y",x:80,y:10},lBumper:{name:"left bumper",style:"bumper",text:"LB",face:"top",x:25,y:70},rBumper:{name:"right bumper",style:"bumper",text:"RB",face:"top",x:75,y:70},lStickClick:{name:"left stick click",style:"stick_click",target:"lStick",x:20,y:20},rStickClick:{name:"right stick click",style:"stick_click",target:"rStick",x:70,y:55},lTrigger:{name:"left trigger",style:"trigger",text:"LT",face:"top",x:25,y:20},rTrigger:{name:"right trigger",style:"trigger",text:"RT",face:"top",x:75,y:20}},axis_dual:{lStick:{name:"left stick",style:"axis",x:20,y:20},rStick:{name:"right stick",style:"axis",x:70,y:55}}},t.gamepads["Playstation 3"]={displayName:"Playstation 3 Controller",idMatches:[["54c","268"]],button:{dpadUp:{style:"dpadUp",x:20,y:12},dpadDown:{style:"dpadDown",x:20,y:28},dpadLeft:{style:"dpadLeft",x:15,y:20},dpadRight:{style:"dpadRight",x:25,y:20},start:{style:"round_small",text:"st",bclass:"ps-mid",x:60,y:20},back:{style:"round_small",text:"sl",bclass:"ps-mid",x:40,y:20},on:{style:"round",text:"ON",bclass:"",x:50,y:32},X:{style:"round",text:"X",bclass:"ps-x",x:80,y:30},SQUARE:{style:"round",text:"[]",bclass:"ps-square",x:74,y:20},CIRCLE:{style:"round",text:"O",bclass:"ps-circle",x:86,y:20},TRIANGLE:{style:"round",text:"^",bclass:"ps-triangle",x:80,y:10},lBumper:{style:"bumper",text:"L1",bclass:"ps-bumper",face:"top",x:25,y:70},rBumper:{style:"bumper",text:"R1",bclass:"ps-bumper",face:"top",x:75,y:70},lStickClick:{style:"stick_click",target:"lStick",x:30,y:45},rStickClick:{style:"stick_click",target:"rStick",x:70,y:45},lTrigger:{style:"trigger",text:"L2",bclass:"ps-trigger",face:"top",x:25,y:20},rTrigger:{style:"trigger",text:"R2",bclass:"ps-trigger",face:"top",x:75,y:20}},axis_dual:{lStick:{style:"axis",x:30,y:45},rStick:{style:"axis",x:70,y:45}}},t.gamepads["Logitech F310"]={displayName:"Logitech F310 Controller",idMatches:[["46d","c21d"],["46d","c21e"],["46d","c216"]],button:{}}}(inpoot),function(t){"use strict";t.keyboards={},t.currentKeyboard="wasd",t.setCurrentKeyboard=function(a){t.currentKeyboard=a},t.getKeyboardMap=function(a){return t.keyboards[t.currentKeyboard][a]},t.keyboards.wasd={8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause/Break",20:"Caps Lock",27:"Esc",32:"Spacebar",33:"Page Up",34:"Page Down",35:"End",36:"Home",37:"Arrow Left",38:"Arrow Up",39:"Arrow Right",40:"Arrow Down",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",189:"_-",187:"=+",186:";:",59:";:",61:"=+",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"Windows",96:"0 (Num Lock)",97:"1 (Num Lock)",98:"2 (Num Lock)",99:"3 (Num Lock)",100:"4 (Num Lock)",101:"5 (Num Lock)",102:"6 (Num Lock)",103:"7 (Num Lock)",104:"8 (Num Lock)",105:"9 (Num Lock)",106:"* (Num Lock)",107:"+ (Num Lock)",109:"- (Num Lock)",110:". (Num Lock)",111:"/ (Num Lock)",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",124:"F12",144:"Num Lock",145:"Scroll Lock",182:"My Computer",183:"My Calculator",188:",<",190:".>",191:"/?",192:"`~",220:"|",221:"]}",222:"'\"",219:"[{"}}(inpoot);